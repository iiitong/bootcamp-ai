# GenSlides - AI 图片幻灯片生成器

## 产品概述

GenSlides 是一个本地运行的单页应用，允许用户通过文字描述生成 AI 图片幻灯片，并支持全屏走马灯播放。应用使用 Nano Banana Pro 模型生成图片，提供流畅的幻灯片创作和展示体验。

## 目标用户

- 需要快速生成视觉内容的创作者
- 演示和展示场景的用户
- 希望将文字创意转化为视觉幻灯片的用户

## 核心功能

### 1. 幻灯片管理

#### 1.1 项目访问
- 通过 URL 访问特定幻灯片项目：`http://localhost:3003/<slug>`
- 项目文件存储在 `./slides/<slug>/` 目录下

#### 1.2 幻灯片列表（左侧边栏）
- 显示所有幻灯片卡片（Slide 1, Slide 2, ...）
- 每个 slide 有唯一的 `sid`，关联若干生成的图片
- **单击**：选中 slide，在右侧显示对应图片
- **双击**：进入编辑模式，修改 slide 的文字内容
- **拖拽排序**：选中 slide 后拖拽可改变幻灯片顺序
- **插入新 slide**：点击某个 slide 下方区域出现插入线，回车创建新 slide

#### 1.3 幻灯片标题
- 顶部可编辑的标题栏，用于设置整个幻灯片组的题头

### 2. 图片生成与展示

#### 2.1 AI 图片生成
- 根据 slide 的文字内容，调用 Nano Banana Pro 生成图片
- 图片保存路径：`./slides/images/<sid>/<blake3_hash>.jpg`
  - `sid`: slide 的唯一标识
  - `blake3_hash`: 文字内容的 blake3 哈希值
- 同一个 slide 可以生成多张图片（不同版本）

#### 2.2 图片展示（右侧主区域）
- 显示当前选中 slide 的图片
- 图片选择逻辑：
  - 优先展示与当前文字内容 blake3 hash 匹配的图片
  - 若无匹配，展示最新生成的图片
- 底部显示缩略图列表，用户可切换预览不同版本
- **生成按钮**：当文本内容变化后，若无对应 hash 的图片，在主图片区域下方显示"生成图片"按钮，用户点击后触发图片生成

#### 2.3 并行生成
- 多个 slide 的图片生成可并行处理，互不影响
- 基准图（如有依赖）需要先生成

#### 2.4 风格图片
- 每个幻灯片项目有一张**风格参考图片**，用于指导后续所有图片的生成风格
- 风格图片保存在 `outline.yml` 中，记录其路径
- **首次打开流程**：
  1. 若项目无风格图片，弹出风格选择 Popup
  2. 用户输入一段描述文字（如"赛博朋克风格"、"水彩画风格"）
  3. 系统生成两张候选风格图片
  4. 用户选择其中一张作为项目的风格参考
  5. 选中的图片保存到 `./slides/images/<slug>/style.jpg`
- 后续生成新图片时，将风格图片作为参考输入

### 3. 全屏播放

#### 3.1 播放功能
- 点击右上角"播放"按钮启动全屏播放
- 从当前选中的 slide 开始播放
- 走马灯形式自动轮播展示所有幻灯片

### 4. 成本控制

- 界面展示当前幻灯片组的总体生成成本
- 帮助用户了解 AI 调用消耗

## 数据存储

### 目录结构
```
./slides/
  └── <slug>/
      └── outline.yml      # 幻灯片文本信息（侧边栏数据源）
./slides/images/
  └── <sid>/
      └── <blake3_hash>.jpg  # 生成的图片文件
```

### outline.yml 格式示例
```yaml
title: "幻灯片标题"
style:
  prompt: "赛博朋克风格，霓虹灯光，未来城市"  # 用户输入的风格描述
  image: "style.jpg"                           # 风格参考图片文件名
slides:
  - sid: "slide-001"
    content: "第一张幻灯片的文字描述"
  - sid: "slide-002"
    content: "第二张幻灯片的文字描述"
```

## 技术架构

### 后端
- **语言**: Python
- **框架**: FastAPI
- **AI SDK**: Google AI SDK (Nano Banana Pro)

### 前端
- **语言**: TypeScript
- **样式**: Tailwind CSS
- **状态管理**: Zustand

### 部署
- 本地运行，无需数据库
- 无需权限管理
- 默认端口: 3003

## 非目标 (Non-Goals)

- 导出为 PPTX 格式
- 多用户协作
- 云端存储和同步

## 成功指标

1. 幻灯片生成流程流畅，无明显卡顿
2. 图片生成支持并行，提升效率
3. 用户能清晰了解使用成本
4. 全屏播放体验流畅

## 用户界面线框图

```
┌─────────────────────────────────────────────────────────────────────────┐
│ [Logo]  │         [幻灯片标题输入框]                    │   [播放]     │
├─────────┼───────────────────────────────────────────────┴──────────────┤
│         │                                                              │
│ ┌─────┐ │                                                              │
│ │Slide│ │                                                              │
│ │  1  │ │                                                              │
│ └─────┘ │              [主图片展示区域]                                 │
│         │                                                              │
│ ┌─────┐ │     图片根据 slide 文字内容生成                              │
│ │Slide│ │     路径: <sid>/<blake3_hash>.jpg                           │
│ │  2  │ │                                                              │
│ └─────┘ │                                                              │
│         │  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐                         │
│  ...    │  │缩略│ │缩略│ │缩略│ │缩略│ │缩略│   [图片版本切换]         │
│         │  │图1 │ │图2 │ │图3 │ │图4 │ │图5 │                         │
│         │  └────┘ └────┘ └────┘ └────┘ └────┘                         │
└─────────┴──────────────────────────────────────────────────────────────┘
```

## 版本历史

| 版本 | 日期 | 描述 |
|------|------|------|
| 0.1 | 2026-02-01 | 初始 PRD |
| 0.2 | 2026-02-01 | 新增拖拽排序、生成按钮、风格图片功能 |
