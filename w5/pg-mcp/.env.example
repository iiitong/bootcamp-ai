# PostgreSQL MCP Server Environment Configuration
# Copy this file to .env and modify as needed
# All environment variables use the PG_MCP_ prefix

# =============================================================================
# Database Configuration
# =============================================================================

# Database alias name (used for referencing in queries)
PG_MCP_DATABASE_NAME=main

# Option 1: Individual connection parameters
PG_MCP_DATABASE_HOST=localhost
PG_MCP_DATABASE_PORT=5432
PG_MCP_DATABASE_DBNAME=mydb
PG_MCP_DATABASE_USER=postgres
PG_MCP_DATABASE_PASSWORD=your_password_here

# Option 2: Connection URL (overrides individual parameters if set)
# PG_MCP_DATABASE_URL=postgresql://user:password@localhost:5432/mydb

# SSL Configuration
# Options: disable, allow, prefer, require
PG_MCP_DATABASE_SSL_MODE=prefer
# PG_MCP_DATABASE_SSL_VERIFY_CERT=true
# PG_MCP_DATABASE_SSL_CA_FILE=/path/to/ca-certificate.crt

# Connection Pool Configuration
PG_MCP_DATABASE_MIN_POOL_SIZE=2
PG_MCP_DATABASE_MAX_POOL_SIZE=10

# =============================================================================
# OpenAI Configuration
# =============================================================================

# Required: OpenAI API Key
PG_MCP_OPENAI_API_KEY=sk-your-openai-api-key-here

# Model to use for SQL generation (default: gpt-4o-mini)
PG_MCP_OPENAI_MODEL=gpt-4o-mini

# Custom API endpoint (optional, for Azure OpenAI or compatible APIs)
# PG_MCP_OPENAI_BASE_URL=https://api.openai.com/v1

# Request settings
PG_MCP_OPENAI_MAX_RETRIES=3
PG_MCP_OPENAI_TIMEOUT=30.0

# =============================================================================
# Server Configuration
# =============================================================================

# Schema cache refresh interval in seconds (default: 3600 = 1 hour)
PG_MCP_SERVER_CACHE_REFRESH_INTERVAL=3600

# Maximum number of rows to return (default: 1000)
PG_MCP_SERVER_MAX_RESULT_ROWS=1000

# Query execution timeout in seconds (default: 30.0)
PG_MCP_SERVER_QUERY_TIMEOUT=30.0

# Maximum retries for SQL generation on syntax error (default: 2)
PG_MCP_SERVER_MAX_SQL_RETRY=2

# Enable LLM result validation (default: false)
PG_MCP_SERVER_ENABLE_RESULT_VALIDATION=false

# Deep defense: Execute queries in read-only transactions (default: true)
# This provides an additional layer of protection against SQL injection
PG_MCP_SERVER_USE_READONLY_TRANSACTIONS=true

# =============================================================================
# Rate Limiting Configuration
# =============================================================================

# Enable rate limiting (default: true)
PG_MCP_RATE_LIMIT_ENABLED=true

# Maximum requests per minute (default: 60)
PG_MCP_RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Maximum requests per hour (default: 1000)
PG_MCP_RATE_LIMIT_REQUESTS_PER_HOUR=1000

# Maximum OpenAI tokens per minute (default: 100000)
PG_MCP_RATE_LIMIT_OPENAI_TOKENS_PER_MINUTE=100000
